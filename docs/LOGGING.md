# Система логирования Network Scanner

## Обзор

Network Scanner поддерживает два типа сборок:
- **Релизная версия (версия 1)** - без логирования, оптимизированная для продакшена
- **Тестовая версия (версия 2)** - с полным логированием для отладки

## Типы сборок

### Релизная версия (по умолчанию)

Релизная версия не содержит логирования и оптимизирована для использования конечными пользователями.

**Сборка:**
```bash
scripts\build.bat release
# или просто
scripts\build.bat
```

**Версия:** 1.0.1 (версия сборки 1)

### Тестовая версия (с логом)

Тестовая версия включает полное логирование всех операций приложения для отладки.

**Сборка:**
```bash
scripts\build.bat debug
```

**Версия:** 1.0.2 (версия сборки 2)

## Файлы логов

В тестовой версии логи записываются в файлы формата:
```
LOG-<название приложения>-<версия>.txt
```

Примеры:
- `LOG-network-scanner-1.0.2.txt` - для CLI версии
- `LOG-network-scanner-gui-1.0.2.txt` - для GUI версии

### Формат лога

Логи записываются в формате UTF-8 с временными метками:
```
[2026-02-27 15:30:45.123] Запуск CLI приложения
[2026-02-27 15:30:45.456] Определена сеть: 192.168.1.0/24
[2026-02-27 15:30:45.789] Начинаю сканирование сети: 192.168.1.0/24
[2026-02-27 15:30:46.012] Сканирование 254 хостов, порты: 1000, таймаут: 2s, потоков: 50
[2026-02-27 15:30:50.345] Найдено активных хостов: 5 из 254
[2026-02-27 15:31:20.678] Сканирование завершено. Найдено устройств: 5
```

### Уровни логирования

- **Log()** - общая информация о работе приложения
- **LogError()** - ошибки с контекстом
- **LogDebug()** - детальная отладочная информация

## Что логируется

### CLI версия

- Запуск и завершение приложения
- Определение сети (автоматическое или ручное)
- Параметры сканирования
- Прогресс сканирования
- Найденные хосты и порты
- Ошибки и предупреждения

### GUI версия

- Запуск и завершение приложения
- Инициализация GUI
- Запуск сканирования
- Определение сети
- Прогресс сканирования
- Ошибки и предупреждения

### Scanner модуль

- Начало и завершение сканирования
- Парсинг сети и портов
- Количество найденных активных хостов
- Сканирование каждого хоста (debug уровень)
- Количество открытых портов на каждом хосте

## Использование логов для отладки

### Типичные проблемы и как их найти в логах

1. **Зависание при сканировании портов**
   - Ищите последнюю запись перед зависанием
   - Проверьте, на каком хосте происходит зависание
   - Проверьте количество активных хостов

2. **Проблемы с определением сети**
   - Ищите записи "Определение сети" или "Определение сети в GUI"
   - Проверьте ошибки с контекстом "Определение сети"

3. **Медленное сканирование**
   - Проверьте количество хостов и портов
   - Проверьте таймауты и количество потоков
   - Ищите записи о времени выполнения операций

4. **Ошибки подключения**
   - Ищите записи "ERROR" в логе
   - Проверьте контекст ошибки

## Технические детали

### Build tags

Система использует Go build tags для разделения версий:

- **Релизная версия:** без тегов (по умолчанию)
- **Тестовая версия:** `-tags debug`

### Реализация

- `internal/logger/logger.go` - реализация с логированием (build tag: `debug`)
- `internal/logger/logger_release.go` - заглушки для релизной версии (build tag: `!debug`)

### Производительность

В релизной версии все функции логирования являются пустыми заглушками, что означает:
- Нулевые накладные расходы на производительность
- Нет проверок условий во время выполнения
- Оптимизация компилятором

## Рекомендации

1. **Для разработки:** всегда используйте тестовую версию с логами
2. **Для тестирования:** используйте тестовую версию для сбора информации о проблемах
3. **Для продакшена:** используйте релизную версию без логов

## Примеры использования

### Сборка тестовой версии для отладки

```bash
cd network-scanner
scripts\build.bat debug
```

### Запуск тестовой версии и сбор логов

```bash
# CLI версия
.\release\2026-02-27-1-debug\network-scanner.exe -range 192.168.1.0/24

# Проверка лога
type LOG-network-scanner-1.0.2.txt
```

### Сборка релизной версии

```bash
scripts\build.bat release
# или просто
scripts\build.bat
```
